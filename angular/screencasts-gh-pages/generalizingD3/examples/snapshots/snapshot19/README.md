Model driven updates

Split `update()` into two functions called in response to model changes.
