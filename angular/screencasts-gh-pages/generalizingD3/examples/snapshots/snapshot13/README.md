Eliminate multiple data fetching

What changed:

 * updateSize renamed to update
 * a `data` variable was introduced
 * data fetching separated from visualization logic
