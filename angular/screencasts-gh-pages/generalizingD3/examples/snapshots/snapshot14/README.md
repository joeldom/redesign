Move data fetching to main

What changed:

 * Added `barChart.setData(data)`
 * Moved data fetching logic into main.js
 * Converted `type` into an inline function
